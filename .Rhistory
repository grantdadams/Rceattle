file = NULL,
inits = NULL, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = "default")
ss_runre <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = ss_run$estimated_params, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = TRUE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = NULL)
ss_run$quantities$SB0
library(Rceattle)
data(BS2017SS) # ?BS2017SS for more information on the data
BS2017SS$projyr <- 2030
ss_run <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = NULL, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = "default")
ss_runre <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = ss_run$estimated_params, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = TRUE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = NULL)
library(Rceattle)
library(Rceattle)
data(BS2017SS) # ?BS2017SS for more information on the data
BS2017SS$projyr <- 2030
ss_run <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = NULL, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = "default")
ss_runre <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = ss_run$estimated_params, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = TRUE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = NULL)
library(Rceattle)
data(BS2017SS) # ?BS2017SS for more information on the data
BS2017SS$projyr <- 2030
ss_run <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = NULL, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = "default")
ss_run_se <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = NULL, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
random_sel = TRUE,
phase = "default")
ss_runre <- Rceattle::fit_mod(data_list = BS2017SS,
file = NULL,
inits = ss_run$estimated_params, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = TRUE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = NULL)
ss_runre$estimated_params$ln_rec_sigma
ss_run$estimated_params$ln_rec_sigma
ss_run_se$estimated_params$ln_sigma_sel
ss_run$estimated_params$ln_sigma_sel
BS2017SS$fleet_control
data("GOA2018SS") # ?BS2017SS for more information on the data
GOA2018SS$projyr <- 2030
ss_run <- Rceattle::fit_mod(data_list = GOA2018SS,
file = NULL,
inits = NULL, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = "default")
ss_runre <- Rceattle::fit_mod(data_list = GOA2018SS,
file = NULL,
inits = ss_run$estimated_params, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = TRUE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
phase = NULL)
ss_run_se <- Rceattle::fit_mod(data_list = GOA2018SS,
file = NULL,
inits = NULL, # Initial parameters = 0
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
verbose = 1,
random_sel = TRUE,
phase = "default")
ss_run_se$estimated_params$ln_sigma_sel
exp(ss_run_se$estimated_params$ln_sigma_sel)
exp(5.298317)
GOA2018SS$fleet_control
library(Rceattle)
devtools::document()
library(Rceattle)
library(Rceattle)
library(Rceattle)
# Code to run Gulf of Alaska CEATTLE model in TMB
# Citation:
# Adams, G. D., Holsman, K. K., Barbeaux, S. J., Dorn, M. W., Ianelli, J. N., Spies, I., ... & Punt, A. E. (2022). An ensemble approach to understand predation mortality for groundfish in the Gulf of Alaska. Fisheries Research, 251, 106303.
library(Rceattle)
################################################
# Data
################################################
# Example
# To run the 2018 single species assessment for the Gulf of Alaska, a data file must first be loaded:
data("GOA2018SS") # Single-species data. ?BS2017SS for more information on the data
################################################
# Estimation
################################################
# - Single-species
# Then the model can be fit by setting `msmMode = 0` using the `Rceattle` function:
GOA2018SS$fleet_control$proj_F_prop <- rep(1, nrow(GOA2018SS$fleet_control))
ss_run <- Rceattle::fit_mod(data_list = GOA2018SS,
inits = NULL, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
library(Rceattle)
# Code to run Gulf of Alaska CEATTLE model in TMB
# Citation:
# Adams, G. D., Holsman, K. K., Barbeaux, S. J., Dorn, M. W., Ianelli, J. N., Spies, I., ... & Punt, A. E. (2022). An ensemble approach to understand predation mortality for groundfish in the Gulf of Alaska. Fisheries Research, 251, 106303.
library(Rceattle)
################################################
# Data
################################################
# Example
# To run the 2018 single species assessment for the Gulf of Alaska, a data file must first be loaded:
data("GOA2018SS") # Single-species data. ?BS2017SS for more information on the data
################################################
# Estimation
################################################
# - Single-species
# Then the model can be fit by setting `msmMode = 0` using the `Rceattle` function:
GOA2018SS$fleet_control$proj_F_prop <- rep(1, nrow(GOA2018SS$fleet_control))
ss_run <- Rceattle::fit_mod(data_list = GOA2018SS,
inits = NULL, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
plot_biomass(ss_run, add_ci = TRUE)
# Single-species, but estimate M
ss_run_M <- Rceattle::fit_mod(data_list = GOA2018SS,
inits = ss_run$estimated_params, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
M1Fun = build_M1(M1_model = c(1,2,1)), # Estimate M
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
plot_biomass(ss_run_M, add_ci = TRUE)
# - Multi-species
# For the a multispecies model we from the single species parameters.
ms_run <- Rceattle::fit_mod(data_list = GOA2018SS,
inits = ss_run_M$estimated_params, # Initial parameters from single species ests
file = NULL, # Don't save
estimateMode = 0, # Estimate
M1Fun = build_M1(M1_model = c(1,2,1)),
niter = 3, # 3 iterations around population and predation dynamics
random_rec = FALSE, # No random recruitment
msmMode = 1, # MSVPA based
suitMode = 0, # empirical suitability
verbose = 1)
plot_biomass(ms_run, add_ci = TRUE)
################################################
# Plotting
################################################
# We can plot all runs
mod_list <- list(ss_run, ss_run_M, ms_run)
mod_names <- c("Single-species", "Single-species estimate M", "Multi-species")
# Plot biomass trajectory
plot_biomass(Rceattle = mod_list, model_names = mod_names)
plot_depletionSSB(Rceattle = mod_list, model_names = mod_names)
plot_recruitment(Rceattle = mod_list, model_names = mod_names, add_ci = TRUE)
# Plot mortality and predation
plot_b_eaten(Rceattle = mod_list, model_names = mod_names) # Biomass eaten as prey
# Plot biomass trajectory
plot_biomass(Rceattle = mod_list, model_names = mod_names, add_ci = TRUE)
# Plot biomass trajectory
plot_biomass(Rceattle = mod_list, model_names = mod_names, add_ci = TRUE)
# Code to run Gulf of Alaska CEATTLE model in TMB
# Citation:
# Adams, G. D., Holsman, K. K., Barbeaux, S. J., Dorn, M. W., Ianelli, J. N., Spies, I., ... & Punt, A. E. (2022). An ensemble approach to understand predation mortality for groundfish in the Gulf of Alaska. Fisheries Research, 251, 106303.
library(Rceattle)
################################################
# Data
################################################
# Example
# To run the 2018 single species assessment for the Gulf of Alaska, a data file must first be loaded:
data("GOA2018SS") # Single-species data. ?BS2017SS for more information on the data
################################################
# Estimation
################################################
# - Single-species
# Then the model can be fit by setting `msmMode = 0` using the `Rceattle` function:
GOA2018SS$fleet_control$proj_F_prop <- rep(1, nrow(GOA2018SS$fleet_control))
ss_run <- Rceattle::fit_mod(data_list = GOA2018SS,
inits = NULL, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
# Grant Adams, Kirstin Holsman, Andre Punt - April 2019
# Code to run Bering Sea CEATTLE model in TMB
# Citation:
# Holsman, K. K., Ianelli, J., Aydin, K., Punt, A. E., and Moffitt, E. A. 2015. A comparison of fisheries biological reference points estimated from temperature-specific multi-species and single-species climate-enhanced stock assessment models. Deep-Sea Research Part II: Topical Studies in Oceanography, 134: 360–378.
library(Rceattle)
################################################
# Data
################################################
# Example
# To run the 2017 single species assessment for the Bering Sea, a data file must first be loaded:
data("BS2017SS") # Single-species data. ?BS2017SS for more information on the data
data("BS2017MS") # Multi-species data. Note: the only difference is the residual mortality (M1_base) is lower
# Write data to excel
Rceattle::write_data(data_list = BS2017SS, file = "BS2017SS.xlsx")
# Change the data how you want in excel
# Read the data back in
mydata <- Rceattle::read_data( file = "BS2017SS.xlsx")
################################################
# Estimation
################################################
# - Single-species
# Then the model can be fit by setting `msmMode = 0` using the `Rceattle` function:
mydata$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ss_run <- Rceattle::fit_mod(data_list = mydata,
inits = NULL, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
plot_biomass(ss_run, add_ci = TRUE)
# Single-species, but estimate M
ss_run_M <- Rceattle::fit_mod(data_list = mydata,
inits = ss_run$estimated_params, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
M1Fun = build_M1(M1_model = 1,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
plot_biomass(ss_run_M, add_ci = TRUE)
# - Multi-species
# For the a multispecies model we from the single species parameters.
BS2017MS$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ms_run <- Rceattle::fit_mod(data_list = BS2017MS,
inits = ss_run$estimated_params, # Initial parameters from single species ests
M1Fun = build_M1(M1_model = 1,
updateM1 = TRUE,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
file = NULL, # Don't save
estimateMode = 0, # Estimate
niter = 3, # 3 iterations around population and predation dynamics
random_rec = FALSE, # No random recruitment
msmMode = 1, # MSVPA based
suitMode = 0, # empirical suitability
verbose = 1)
ms_run$quantities$SB0
ms_run$quantities$biomassSSB
ss_run_M$quantities$biomassSSB
ms_run$quantities$biomassSSB
ms_run$quantities$biomass[,79]
ms_run$quantities$biomass[,78]
ms_run$quantities$biomass[,70]
ms_run$quantities$biomass[,72]
ss_run_M$quantities$biomass[,72]
library(Rceattle)
# Grant Adams, Kirstin Holsman, Andre Punt - April 2019
# Code to run Bering Sea CEATTLE model in TMB
# Citation:
# Holsman, K. K., Ianelli, J., Aydin, K., Punt, A. E., and Moffitt, E. A. 2015. A comparison of fisheries biological reference points estimated from temperature-specific multi-species and single-species climate-enhanced stock assessment models. Deep-Sea Research Part II: Topical Studies in Oceanography, 134: 360–378.
library(Rceattle)
################################################
# Data
################################################
# Example
# To run the 2017 single species assessment for the Bering Sea, a data file must first be loaded:
data("BS2017SS") # Single-species data. ?BS2017SS for more information on the data
data("BS2017MS") # Multi-species data. Note: the only difference is the residual mortality (M1_base) is lower
# Write data to excel
Rceattle::write_data(data_list = BS2017SS, file = "BS2017SS.xlsx")
# Change the data how you want in excel
# Read the data back in
mydata <- Rceattle::read_data( file = "BS2017SS.xlsx")
################################################
# Estimation
################################################
# - Single-species
# Then the model can be fit by setting `msmMode = 0` using the `Rceattle` function:
mydata$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ss_run <- Rceattle::fit_mod(data_list = mydata,
inits = NULL, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
plot_biomass(ss_run, add_ci = TRUE)
# Single-species, but estimate M
ss_run_M <- Rceattle::fit_mod(data_list = mydata,
inits = ss_run$estimated_params, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
M1Fun = build_M1(M1_model = 1,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
plot_biomass(ss_run_M, add_ci = TRUE)
ms_run <- Rceattle::fit_mod(data_list = BS2017MS,
inits = ss_run$estimated_params, # Initial parameters from single species ests
M1Fun = build_M1(M1_model = 1,
updateM1 = TRUE,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
HCR = Rceattle::build_hcr(HCR = 6, # Cat 1 HCR
FsprLimit = 0.4, # F40%
Ptarget = 0.4, # Target is 40% B0
Plimit = 0.1, # No fishing when SB<SB10
Pstar = 0.45,
Sigma = 0.5),
file = NULL, # Don't save
estimateMode = 0, # Estimate
niter = 3, # 3 iterations around population and predation dynamics
random_rec = FALSE, # No random recruitment
msmMode = 1, # MSVPA based
suitMode = 0, # empirical suitability
verbose = 1)
BS2017MS$fleet_control$proj_F_prop
BS2017MS$fleet_control$proj_F_prop <- rep(1, 7)
BS2017MS$fleet_control$proj_F_prop
# - Multi-species
BS2017MS$fleet_control$proj_F_prop <- rep(1, 7)
# - Multi-species
# For the a multispecies model we from the single species parameters.
BS2017MS$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ms_run <- Rceattle::fit_mod(data_list = BS2017MS,
inits = ss_run$estimated_params, # Initial parameters from single species ests
M1Fun = build_M1(M1_model = 1,
updateM1 = TRUE,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
HCR = Rceattle::build_hcr(HCR = 6, # Cat 1 HCR
FsprLimit = 0.4, # F40%
Ptarget = 0.4, # Target is 40% B0
Plimit = 0.1, # No fishing when SB<SB10
Pstar = 0.45,
Sigma = 0.5),
file = NULL, # Don't save
estimateMode = 0, # Estimate
niter = 3, # 3 iterations around population and predation dynamics
random_rec = FALSE, # No random recruitment
msmMode = 1, # MSVPA based
suitMode = 0, # empirical suitability
verbose = 1)
ms_run3 <- Rceattle::fit_mod(data_list = BS2017MS,
inits = ss_run$estimated_params, # Initial parameters from single species ests
M1Fun = build_M1(M1_model = 1,
updateM1 = TRUE,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
HCR = Rceattle::build_hcr(HCR = 3, # Cat 1 HCR
FsprTarget = 0.4),
file = NULL, # Don't save
estimateMode = 0, # Estimate
niter = 3, # 3 iterations around population and predation dynamics
random_rec = FALSE, # No random recruitment
msmMode = 1, # MSVPA based
suitMode = 0, # empirical suitability
verbose = 1)
plot_biomass(list(ms_run, ms_run3), add_ci = TRUE, incl_proj = TRUE)
plot_depletionSSB(list(ms_run, ms_run3), add_ci = TRUE, incl_proj = TRUE)
devtools::document()
################################################
# Data
################################################
library(Rceattle)
# Example
# To run the 2017 single species assessment for the Bering Sea, a data file must first be loaded:
data("BS2017SS") # Single-species data. ?BS2017SS for more information on the data
data("BS2017MS") # Multi-species data. Note: the only difference is the residual mortality (M1_base) is lower
################################################
# Estimation
################################################
# - Single-species
BS2017SS$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ss_run <- Rceattle::fit_mod(data_list = BS2017SS,
inits = NULL, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
ss_run$quantities$SB0
ss_run$quantities$biomassSSB[,ncol(ss_run$quantities$biomassSSB)]
# - Multi-species
# For the a multispecies model we from the single species parameters.
BS2017MS$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ms_run <- Rceattle::fit_mod(data_list = BS2017MS,
inits = ss_run$estimated_params, # Initial parameters from single species ests
M1Fun = build_M1(M1_model = 1,
updateM1 = TRUE,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
file = NULL, # Don't save
estimateMode = 0, # Estimate
niter = 3, # 3 iterations around population and predation dynamics
random_rec = FALSE, # No random recruitment
msmMode = 1, # MSVPA based
suitMode = 0, # empirical suitability
verbose = 1)
plot_biomass(list(ss_run, ms_run), add_ci = TRUE, incl_proj = = TRUE)
plot_biomass(list(ss_run, ms_run), add_ci = TRUE, incl_proj = TRUE)
plot_recruitment(list(ss_run, ms_run), add_ci = TRUE, incl_proj = TRUE)
plot_biomass(list(ss_run, ms_run), add_ci = TRUE, incl_proj = TRUE)
is lower
BS2017SS$projyr <- 2100
BS2017MS$projyr <- 2100
################################################
# Estimation
################################################
# - Single-species
BS2017SS$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ss_run <- Rceattle::fit_mod(data_list = BS2017SS,
inits = NULL, # Initial parameters = 0
file = NULL, # Don't save
estimateMode = 0, # Estimate
random_rec = FALSE, # No random recruitment
msmMode = 0, # Single species mode
phase = "default",
verbose = 1)
ss_run$quantities$SB0
ss_run$quantities$biomassSSB[,ncol(ss_run$quantities$biomassSSB)]
# - Multi-species
# For the a multispecies model we from the single species parameters.
BS2017MS$fleet_control$proj_F_prop <- c(rep(1,3), rep(0,4))
ms_run <- Rceattle::fit_mod(data_list = BS2017MS,
inits = ss_run$estimated_params, # Initial parameters from single species ests
M1Fun = build_M1(M1_model = 1,
updateM1 = TRUE,
M1_use_prior = FALSE,
M2_use_prior = FALSE),
file = NULL, # Don't save
estimateMode = 0, # Estimate
niter = 3, # 3 iterations around population and predation dynamics
random_rec = FALSE, # No random recruitment
msmMode = 1, # MSVPA based
suitMode = 0, # empirical suitability
verbose = 1)
plot_biomass(list(ss_run, ms_run), add_ci = TRUE, incl_proj = TRUE)
plot_recruitment(list(ss_run, ms_run), add_ci = TRUE, incl_proj = TRUE)
yrs <- BS2017SS$styr:BS2017SS$projyr
nyrs <- length(yrs)
ss_run$quantities$NByage[1,1,,nyrs]
ms_run$quantities$NByage[1,1,,nyrs]
round(ss_run$quantities$M[1,1,,nyrs], 3) # Single species
round(ms_run$quantities$M1[1,1,,nyrs], 3) # Multi species
round(ms_run$quantities$M1[1,1,], 3) # Multi species
ss_run$quantities$SB0
ss_run$quantities$biomassSSB[,ncol(ss_run$quantities$biomassSSB)]
round(ss_run$quantities$biomassSSBByage[1,1,,nyrs]) # Single species n-at-age
dim(round(ss_run$quantities$biomassSSBByage)
)
round(ss_run$quantities$biomassSSBByage[1,,nyrs]) # Single species n-at-age
library(Rceattle)
library(Rceattle)
