% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/0-ceattle_equations_v11.R
\name{ddirmultinom}
\alias{ddirmultinom}
\title{#' Maintain a value above a limit with penalty adjustment
#'
#' @param x A numeric value.
#' @param eps A numeric threshold.
#' @param penalty A numeric value representing the current penalty.
#' @return A list containing the adjusted value and updated penalty.
posfun <- function(x, eps = 0.001) {
denom <- 2 - x / eps
ans <- ifelse(x >= eps, x, eps / denom)
penalty <- ifelse(x < eps, 0.01 * (x - eps)^2, 0)
return(list(ans = ans, penalty = penalty))
}
Calculate the Dirichlet multinomial log-likelihood}
\usage{
ddirmultinom(obs, alpha, do_log = FALSE)
}
\arguments{
\item{obs}{A numeric vector of observed counts.}

\item{alpha}{A numeric vector of Dirichlet parameters.}

\item{do_log}{A logical indicating whether to return the log-likelihood.}
}
\value{
The log-likelihood or the exponentiated likelihood.
}
\description{
#' Maintain a value above a limit with penalty adjustment
#'
#' @param x A numeric value.
#' @param eps A numeric threshold.
#' @param penalty A numeric value representing the current penalty.
#' @return A list containing the adjusted value and updated penalty.
posfun <- function(x, eps = 0.001) {
denom <- 2 - x / eps
ans <- ifelse(x >= eps, x, eps / denom)
penalty <- ifelse(x < eps, 0.01 * (x - eps)^2, 0)
return(list(ans = ans, penalty = penalty))
}
Calculate the Dirichlet multinomial log-likelihood
}
